<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Field Guide to the R Mixed Model Wilderness - 5&nbsp; Split Plot Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/factorial-design.html" rel="next">
<link href="../chapters/rcbd.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Field Guide to the R Mixed Model Wilderness</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/split-plot-design.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Split Plot Design</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/hexLogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/analysis-tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tips on Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Mixed model theory and background</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/rcbd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Randomized Complete Block Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/split-plot-design.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Split Plot Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/factorial-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Factorial Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/repeated-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Repeated measures mixed models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/incomplete-block-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Balanced Incomplete Block Experiment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lattice-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">lattice_design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/glmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Generalized Linear Mixed Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/special-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Combining Scenarios</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/analysis-tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tips on Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/variance-components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Variance Components</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#details-for-split-plot-designs" id="toc-details-for-split-plot-designs" class="nav-link active" data-scroll-target="#details-for-split-plot-designs"><span class="header-section-number">5.1</span> Details for Split Plot Designs</a></li>
  <li><a href="#analysis-examples" id="toc-analysis-examples" class="nav-link" data-scroll-target="#analysis-examples"><span class="header-section-number">5.2</span> Analysis Examples</a>
  <ul class="collapse">
  <li><a href="#example-model-for-crd-split-plot-designs" id="toc-example-model-for-crd-split-plot-designs" class="nav-link" data-scroll-target="#example-model-for-crd-split-plot-designs"><span class="header-section-number">5.2.1</span> Example model for CRD Split Plot Designs</a></li>
  <li><a href="#example-model-for-rcbd-split-plot-designs" id="toc-example-model-for-rcbd-split-plot-designs" class="nav-link" data-scroll-target="#example-model-for-rcbd-split-plot-designs"><span class="header-section-number">5.2.2</span> Example model for RCBD Split Plot Designs</a></li>
  </ul></li>
  <li><a href="#split-split-plot-design" id="toc-split-split-plot-design" class="nav-link" data-scroll-target="#split-split-plot-design"><span class="header-section-number">6</span> Split-split plot design</a>
  <ul class="collapse">
  <li><a href="#details-for-split-split-plot-designs" id="toc-details-for-split-split-plot-designs" class="nav-link" data-scroll-target="#details-for-split-split-plot-designs"><span class="header-section-number">6.1</span> Details for split-split plot designs</a></li>
  <li><a href="#example-analysis" id="toc-example-analysis" class="nav-link" data-scroll-target="#example-analysis"><span class="header-section-number">6.2</span> Example Analysis</a>
  <ul class="collapse">
  <li><a href="#load-data-and-integrity-checks" id="toc-load-data-and-integrity-checks" class="nav-link" data-scroll-target="#load-data-and-integrity-checks"><span class="header-section-number">6.2.1</span> <em>Load Data and integrity checks</em></a></li>
  <li><a href="#model-building-1" id="toc-model-building-1" class="nav-link" data-scroll-target="#model-building-1"><span class="header-section-number">6.2.2</span> Model Building</a></li>
  <li><a href="#check-model-assumptions-2" id="toc-check-model-assumptions-2" class="nav-link" data-scroll-target="#check-model-assumptions-2"><span class="header-section-number">6.2.3</span> Check Model Assumptions</a></li>
  <li><a href="#inference-2" id="toc-inference-2" class="nav-link" data-scroll-target="#inference-2"><span class="header-section-number">6.2.4</span> Inference</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Split Plot Design</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Split-plot design is frequently used for factorial experiments. Such design may incorporate one or more of the completely randomized (CRD), completely randomized block (RCBD), and Latin square designs. The main principle is that there are whole plots or whole units, to which the levels of one or more factors are applied. Thus each whole plot becomes a block for the subplot treatments.</p>
<section id="details-for-split-plot-designs" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="details-for-split-plot-designs"><span class="header-section-number">5.1</span> Details for Split Plot Designs</h2>
<ol type="1">
<li>Whole Plot Randomized as a completely randomized design</li>
</ol>
<p>The statistical model structure this design:</p>
<p><span class="math display">\[y_{ijk} = \mu + \alpha_i + \beta_k + (\alpha_j\beta_k) + \epsilon_{ij} + \delta_{ijk} \]</span> Where:</p>
<p><span class="math inline">\(\mu\)</span>= overall experimental mean, <span class="math inline">\(\alpha\)</span> = main effect of whole plot (fixed), <span class="math inline">\(\beta\)</span> = main effect of subplot (fixed), <span class="math inline">\(\alpha\)</span><span class="math inline">\(\tau\)</span> = interaction between factors A and B, <span class="math inline">\(\epsilon_{ij}\)</span> = whole plot error, <span class="math inline">\(\delta_{ijk}\)</span> = subplot error.</p>
<p><span class="math display">\[ \epsilon \sim N(0, \sigma_\epsilon)\]</span></p>
<p><span class="math display">\[\ \delta  \sim N(0, \sigma_\delta)\]</span></p>
<p>Both the error and the rep effects are assumed to be normally distributed with a mean of zero and standard deviations of <span class="math inline">\(\sigma_\epsilon\)</span> and <span class="math inline">\(\sigma_\delta\)</span>, respectively.</p>
<ol start="2" type="1">
<li>Whole Plot Randomized as an RCBD</li>
</ol>
<p>This is also referred as “Split-Block RCB” design. The statistical model structure for split plot design:</p>
<p><span class="math display">\[y_{ijk} = \mu + \rho_j +  \alpha_i + \beta_k + (\alpha_i\beta_k) + \epsilon_{ij} + \delta_{ijk}\]</span> Where:</p>
<p><span class="math inline">\(\mu\)</span> = overall experimental mean, <span class="math inline">\(\rho\)</span> = block effect (random), <span class="math inline">\(\alpha\)</span> = main effect of whole plot (fixed), <span class="math inline">\(\beta\)</span> = main effect of subplot (fixed), <span class="math inline">\(\alpha\)</span><span class="math inline">\(\beta\)</span> = interaction between factors A and B, <span class="math inline">\(\epsilon_{ij}\)</span> = whole plot error, <span class="math inline">\(\delta_{ijk}\)</span> = subplot error.</p>
<p><span class="math display">\[ \epsilon \sim N(0, \sigma_\epsilon)\]</span></p>
<p><span class="math display">\[\ \delta  \sim N(0, \sigma_\delta)\]</span></p>
<p>Both the overall error and the rep effects are assumed to be normally distributed with a mean of zero and standard deviations of <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\sigma_\delta\)</span>, respectively.</p>
<section id="iid-assumption-for-error-terms" class="level4" data-number="5.1.0.1">
<h4 data-number="5.1.0.1" class="anchored" data-anchor-id="iid-assumption-for-error-terms"><span class="header-section-number">5.1.0.1</span> ‘iid’ assumption for error terms</h4>
<p>In these model, the error terms, <span class="math inline">\(\epsilon\)</span> are assumed to be “iid”, that is, independently and identically distributed. This means they have constant variance and they each individual error term is independent from the others.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/split_plot_CRD-01.jpeg" class="img-fluid figure-img" width="341"></p>
<figcaption>Split Plot CRD Design</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Split_plot_RCBD.jpeg" class="img-fluid figure-img" width="348"></p>
<figcaption>Split Plot RCBD Design</figcaption>
</figure>
</div>
</section>
</section>
<section id="analysis-examples" class="level2 page-columns page-full" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="analysis-examples"><span class="header-section-number">5.2</span> Analysis Examples</h2>
<section id="example-model-for-crd-split-plot-designs" class="level3 page-columns page-full" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="example-model-for-crd-split-plot-designs"><span class="header-section-number">5.2.1</span> Example model for CRD Split Plot Designs</h3>
<ol type="1">
<li>Load required libraries</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="import-height-data-and-check-the-data-integrity." class="level4" data-number="5.2.1.1">
<h4 data-number="5.2.1.1" class="anchored" data-anchor-id="import-height-data-and-check-the-data-integrity."><span class="header-section-number">5.2.1.1</span> <strong>Import height data and check the data integrity.</strong></h4>
<p>The data (Height data) for this example involves a CRD split plot designed experiment. Treatments are 4 Timings (times) and 8 managements (manage). The whole plots are times and management represents subplot and 3 replications.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"height_data.xlsx"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Run a cross tabulation using <code>table()</code> to check the arrangement of whole-plots and sub-plots.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(height_data<span class="sc">$</span>time, height_data<span class="sc">$</span>manage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    
     M1 M2 M3 M4 M5 M6 M7 M8
  T1  6  6  6  6  6  6  6  6
  T2  6  6  6  6  6  6  6  6
  T3  6  6  6  6  6  6  6  6
  T4  6  6  6  6  6  6  6  6</code></pre>
</div>
</div>
<ul>
<li>Look at structure of the data using <code>str()</code>, this will help in identifying class of the variable. In this dataset, class of the whole-plot, sub-plot, and block should be factor/character and response variable (height) should be numeric.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(height_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [192 × 5] (S3: tbl_df/tbl/data.frame)
 $ time  : chr [1:192] "T1" "T1" "T1" "T1" ...
 $ manage: chr [1:192] "M1" "M2" "M3" "M4" ...
 $ rep   : chr [1:192] "R1" "R1" "R1" "R1" ...
 $ sample: chr [1:192] "S1" "S1" "S1" "S1" ...
 $ height: num [1:192] 104.5 92.3 96.8 94.7 105.7 ...</code></pre>
</div>
</div>
<ul>
<li>Check the number of missing values in each column.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(height_data, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  time manage    rep sample height 
     0      0      0      0      0 </code></pre>
</div>
</div>
<ul>
<li>Exploratory boxplot to look at the height observations at different times with variable managements.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> height_data, <span class="fu">aes</span>(<span class="at">y =</span> height, <span class="at">x =</span> time)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">colour =</span> manage))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="split-plot-design_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-building" class="level4 page-columns page-full" data-number="5.2.1.2">
<h4 data-number="5.2.1.2" class="anchored" data-anchor-id="model-building"><span class="header-section-number">5.2.1.2</span> <strong>Model building</strong></h4>

<div class="no-row-height column-margin column-container"><div class="">
<p>Recall the model:</p>
<p><span class="math display">\[y_{ijk} = \mu + \gamma_i +  \alpha_j + \beta_k + (\alpha_j\beta_k) + \epsilon_{ijk}\]</span></p>
<p>For this model, <span class="math inline">\(\gamma\)</span> = block/rep effect (random), <span class="math inline">\(\alpha\)</span> = main effect of whole plot (fixed), <span class="math inline">\(\beta\)</span> = main effect of subplot (fixed), <span class="math inline">\(\alpha\)</span><span class="math inline">\(\beta\)</span> = interaction between factors A and B (fixed).</p>
</div></div><p>In order to test the main effects of the treatments as well as the interaction between two factors, we can specify that in model as: <code>time + manage + time:manage</code> or <code>time*manage</code>.</p>
<p>When dealing with split plot design across reps or blocks, the random effects needs to be nested hierarchically, from largest unit to smallest. For example, in this example the random effects will be designated as <code>(1 | rep/time)</code>. This implies that random intercepts vary with rep and time within rep.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">lme4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">nlme</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="fu">lmer</span>(height <span class="sc">~</span> time<span class="sc">*</span>manage <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>rep<span class="sc">/</span>time), <span class="at">data=</span>height_data)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: height ~ time * manage + (1 | rep/time)
   Data: height_data

REML criterion at convergence: 997.8

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.53183 -0.60511 -0.07333  0.62458  1.97914 

Random effects:
 Groups   Name        Variance Std.Dev.
 time:rep (Intercept)  0.6118  0.7822  
 rep      (Intercept) 20.1069  4.4841  
 Residual             19.5318  4.4195  
Number of obs: 192, groups:  time:rep, 12; rep, 3

Fixed effects:
                Estimate Std. Error t value
(Intercept)     108.0333     3.1877  33.890
timeT2            3.1833     2.6303   1.210
timeT3           -2.2500     2.6303  -0.855
timeT4            1.2833     2.6303   0.488
manageM2         -4.4500     2.5516  -1.744
manageM3         -5.3000     2.5516  -2.077
manageM4         -6.1833     2.5516  -2.423
manageM5         -5.0167     2.5516  -1.966
manageM6         -3.4167     2.5516  -1.339
manageM7         -9.7500     2.5516  -3.821
manageM8         -4.6667     2.5516  -1.829
timeT2:manageM2  -1.4167     3.6085  -0.393
timeT3:manageM2   0.4667     3.6085   0.129
timeT4:manageM2  -4.6667     3.6085  -1.293
timeT2:manageM3  -1.9667     3.6085  -0.545
timeT3:manageM3  -2.3500     3.6085  -0.651
timeT4:manageM3  -0.8667     3.6085  -0.240
timeT2:manageM4   3.1000     3.6085   0.859
timeT3:manageM4   0.9000     3.6085   0.249
timeT4:manageM4   7.8500     3.6085   2.175
timeT2:manageM5  -1.0167     3.6085  -0.282
timeT3:manageM5  -0.9000     3.6085  -0.249
timeT4:manageM5  -2.4667     3.6085  -0.684
timeT2:manageM6   0.5333     3.6085   0.148
timeT3:manageM6  -3.9333     3.6085  -1.090
timeT4:manageM6   1.1167     3.6085   0.309
timeT2:manageM7  -1.9333     3.6085  -0.536
timeT3:manageM7   1.0667     3.6085   0.296
timeT4:manageM7  -1.3833     3.6085  -0.383
timeT2:manageM8  -1.3167     3.6085  -0.365
timeT3:manageM8  -0.8167     3.6085  -0.226
timeT4:manageM8  -0.2000     3.6085  -0.055</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 32 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span><span class="fu">lme</span>(height <span class="sc">~</span> time<span class="sc">*</span>manage,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">random=</span><span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>rep<span class="sc">/</span>time, <span class="at">data=</span>height_data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: height_data 
       AIC      BIC    logLik
  1067.782 1175.413 -498.8911

Random effects:
 Formula: ~1 | rep
        (Intercept)
StdDev:    4.483903

 Formula: ~1 | time %in% rep
        (Intercept) Residual
StdDev:   0.7822445 4.419479

Fixed effects:  height ~ time * manage 
                    Value Std.Error  DF  t-value p-value
(Intercept)     108.03333  3.187642 152 33.89130  0.0000
timeT2            3.18333  2.630311   6  1.21025  0.2717
timeT3           -2.25000  2.630311   6 -0.85541  0.4252
timeT4            1.28333  2.630311   6  0.48790  0.6429
manageM2         -4.45000  2.551588 152 -1.74401  0.0832
manageM3         -5.30000  2.551588 152 -2.07714  0.0395
manageM4         -6.18333  2.551588 152 -2.42333  0.0166
manageM5         -5.01667  2.551588 152 -1.96610  0.0511
manageM6         -3.41667  2.551588 152 -1.33904  0.1826
manageM7         -9.75000  2.551588 152 -3.82115  0.0002
manageM8         -4.66667  2.551588 152 -1.82893  0.0694
timeT2:manageM2  -1.41667  3.608490 152 -0.39259  0.6952
timeT3:manageM2   0.46667  3.608490 152  0.12932  0.8973
timeT4:manageM2  -4.66667  3.608490 152 -1.29325  0.1979
timeT2:manageM3  -1.96667  3.608490 152 -0.54501  0.5865
timeT3:manageM3  -2.35000  3.608490 152 -0.65124  0.5159
timeT4:manageM3  -0.86667  3.608490 152 -0.24017  0.8105
timeT2:manageM4   3.10000  3.608490 152  0.85909  0.3916
timeT3:manageM4   0.90000  3.608490 152  0.24941  0.8034
timeT4:manageM4   7.85000  3.608490 152  2.17543  0.0311
timeT2:manageM5  -1.01667  3.608490 152 -0.28174  0.7785
timeT3:manageM5  -0.90000  3.608490 152 -0.24941  0.8034
timeT4:manageM5  -2.46667  3.608490 152 -0.68357  0.4953
timeT2:manageM6   0.53333  3.608490 152  0.14780  0.8827
timeT3:manageM6  -3.93333  3.608490 152 -1.09002  0.2774
timeT4:manageM6   1.11667  3.608490 152  0.30946  0.7574
timeT2:manageM7  -1.93333  3.608490 152 -0.53577  0.5929
timeT3:manageM7   1.06667  3.608490 152  0.29560  0.7679
timeT4:manageM7  -1.38333  3.608490 152 -0.38336  0.7020
timeT2:manageM8  -1.31667  3.608490 152 -0.36488  0.7157
timeT3:manageM8  -0.81667  3.608490 152 -0.22632  0.8213
timeT4:manageM8  -0.20000  3.608490 152 -0.05542  0.9559
 Correlation: 
                (Intr) timeT2 timeT3 timeT4 mangM2 mangM3 mangM4 mangM5 mangM6
timeT2          -0.413                                                        
timeT3          -0.413  0.500                                                 
timeT4          -0.413  0.500  0.500                                          
manageM2        -0.400  0.485  0.485  0.485                                   
manageM3        -0.400  0.485  0.485  0.485  0.500                            
manageM4        -0.400  0.485  0.485  0.485  0.500  0.500                     
manageM5        -0.400  0.485  0.485  0.485  0.500  0.500  0.500              
manageM6        -0.400  0.485  0.485  0.485  0.500  0.500  0.500  0.500       
manageM7        -0.400  0.485  0.485  0.485  0.500  0.500  0.500  0.500  0.500
manageM8        -0.400  0.485  0.485  0.485  0.500  0.500  0.500  0.500  0.500
timeT2:manageM2  0.283 -0.686 -0.343 -0.343 -0.707 -0.354 -0.354 -0.354 -0.354
timeT3:manageM2  0.283 -0.343 -0.686 -0.343 -0.707 -0.354 -0.354 -0.354 -0.354
timeT4:manageM2  0.283 -0.343 -0.343 -0.686 -0.707 -0.354 -0.354 -0.354 -0.354
timeT2:manageM3  0.283 -0.686 -0.343 -0.343 -0.354 -0.707 -0.354 -0.354 -0.354
timeT3:manageM3  0.283 -0.343 -0.686 -0.343 -0.354 -0.707 -0.354 -0.354 -0.354
timeT4:manageM3  0.283 -0.343 -0.343 -0.686 -0.354 -0.707 -0.354 -0.354 -0.354
timeT2:manageM4  0.283 -0.686 -0.343 -0.343 -0.354 -0.354 -0.707 -0.354 -0.354
timeT3:manageM4  0.283 -0.343 -0.686 -0.343 -0.354 -0.354 -0.707 -0.354 -0.354
timeT4:manageM4  0.283 -0.343 -0.343 -0.686 -0.354 -0.354 -0.707 -0.354 -0.354
timeT2:manageM5  0.283 -0.686 -0.343 -0.343 -0.354 -0.354 -0.354 -0.707 -0.354
timeT3:manageM5  0.283 -0.343 -0.686 -0.343 -0.354 -0.354 -0.354 -0.707 -0.354
timeT4:manageM5  0.283 -0.343 -0.343 -0.686 -0.354 -0.354 -0.354 -0.707 -0.354
timeT2:manageM6  0.283 -0.686 -0.343 -0.343 -0.354 -0.354 -0.354 -0.354 -0.707
timeT3:manageM6  0.283 -0.343 -0.686 -0.343 -0.354 -0.354 -0.354 -0.354 -0.707
timeT4:manageM6  0.283 -0.343 -0.343 -0.686 -0.354 -0.354 -0.354 -0.354 -0.707
timeT2:manageM7  0.283 -0.686 -0.343 -0.343 -0.354 -0.354 -0.354 -0.354 -0.354
timeT3:manageM7  0.283 -0.343 -0.686 -0.343 -0.354 -0.354 -0.354 -0.354 -0.354
timeT4:manageM7  0.283 -0.343 -0.343 -0.686 -0.354 -0.354 -0.354 -0.354 -0.354
timeT2:manageM8  0.283 -0.686 -0.343 -0.343 -0.354 -0.354 -0.354 -0.354 -0.354
timeT3:manageM8  0.283 -0.343 -0.686 -0.343 -0.354 -0.354 -0.354 -0.354 -0.354
timeT4:manageM8  0.283 -0.343 -0.343 -0.686 -0.354 -0.354 -0.354 -0.354 -0.354
                mangM7 mangM8 tT2:M2 tT3:M2 tT4:M2 tT2:M3 tT3:M3 tT4:M3 tT2:M4
timeT2                                                                        
timeT3                                                                        
timeT4                                                                        
manageM2                                                                      
manageM3                                                                      
manageM4                                                                      
manageM5                                                                      
manageM6                                                                      
manageM7                                                                      
manageM8         0.500                                                        
timeT2:manageM2 -0.354 -0.354                                                 
timeT3:manageM2 -0.354 -0.354  0.500                                          
timeT4:manageM2 -0.354 -0.354  0.500  0.500                                   
timeT2:manageM3 -0.354 -0.354  0.500  0.250  0.250                            
timeT3:manageM3 -0.354 -0.354  0.250  0.500  0.250  0.500                     
timeT4:manageM3 -0.354 -0.354  0.250  0.250  0.500  0.500  0.500              
timeT2:manageM4 -0.354 -0.354  0.500  0.250  0.250  0.500  0.250  0.250       
timeT3:manageM4 -0.354 -0.354  0.250  0.500  0.250  0.250  0.500  0.250  0.500
timeT4:manageM4 -0.354 -0.354  0.250  0.250  0.500  0.250  0.250  0.500  0.500
timeT2:manageM5 -0.354 -0.354  0.500  0.250  0.250  0.500  0.250  0.250  0.500
timeT3:manageM5 -0.354 -0.354  0.250  0.500  0.250  0.250  0.500  0.250  0.250
timeT4:manageM5 -0.354 -0.354  0.250  0.250  0.500  0.250  0.250  0.500  0.250
timeT2:manageM6 -0.354 -0.354  0.500  0.250  0.250  0.500  0.250  0.250  0.500
timeT3:manageM6 -0.354 -0.354  0.250  0.500  0.250  0.250  0.500  0.250  0.250
timeT4:manageM6 -0.354 -0.354  0.250  0.250  0.500  0.250  0.250  0.500  0.250
timeT2:manageM7 -0.707 -0.354  0.500  0.250  0.250  0.500  0.250  0.250  0.500
timeT3:manageM7 -0.707 -0.354  0.250  0.500  0.250  0.250  0.500  0.250  0.250
timeT4:manageM7 -0.707 -0.354  0.250  0.250  0.500  0.250  0.250  0.500  0.250
timeT2:manageM8 -0.354 -0.707  0.500  0.250  0.250  0.500  0.250  0.250  0.500
timeT3:manageM8 -0.354 -0.707  0.250  0.500  0.250  0.250  0.500  0.250  0.250
timeT4:manageM8 -0.354 -0.707  0.250  0.250  0.500  0.250  0.250  0.500  0.250
                tT3:M4 tT4:M4 tT2:M5 tT3:M5 tT4:M5 tT2:M6 tT3:M6 tT4:M6 tT2:M7
timeT2                                                                        
timeT3                                                                        
timeT4                                                                        
manageM2                                                                      
manageM3                                                                      
manageM4                                                                      
manageM5                                                                      
manageM6                                                                      
manageM7                                                                      
manageM8                                                                      
timeT2:manageM2                                                               
timeT3:manageM2                                                               
timeT4:manageM2                                                               
timeT2:manageM3                                                               
timeT3:manageM3                                                               
timeT4:manageM3                                                               
timeT2:manageM4                                                               
timeT3:manageM4                                                               
timeT4:manageM4  0.500                                                        
timeT2:manageM5  0.250  0.250                                                 
timeT3:manageM5  0.500  0.250  0.500                                          
timeT4:manageM5  0.250  0.500  0.500  0.500                                   
timeT2:manageM6  0.250  0.250  0.500  0.250  0.250                            
timeT3:manageM6  0.500  0.250  0.250  0.500  0.250  0.500                     
timeT4:manageM6  0.250  0.500  0.250  0.250  0.500  0.500  0.500              
timeT2:manageM7  0.250  0.250  0.500  0.250  0.250  0.500  0.250  0.250       
timeT3:manageM7  0.500  0.250  0.250  0.500  0.250  0.250  0.500  0.250  0.500
timeT4:manageM7  0.250  0.500  0.250  0.250  0.500  0.250  0.250  0.500  0.500
timeT2:manageM8  0.250  0.250  0.500  0.250  0.250  0.500  0.250  0.250  0.500
timeT3:manageM8  0.500  0.250  0.250  0.500  0.250  0.250  0.500  0.250  0.250
timeT4:manageM8  0.250  0.500  0.250  0.250  0.500  0.250  0.250  0.500  0.250
                tT3:M7 tT4:M7 tT2:M8 tT3:M8
timeT2                                     
timeT3                                     
timeT4                                     
manageM2                                   
manageM3                                   
manageM4                                   
manageM5                                   
manageM6                                   
manageM7                                   
manageM8                                   
timeT2:manageM2                            
timeT3:manageM2                            
timeT4:manageM2                            
timeT2:manageM3                            
timeT3:manageM3                            
timeT4:manageM3                            
timeT2:manageM4                            
timeT3:manageM4                            
timeT4:manageM4                            
timeT2:manageM5                            
timeT3:manageM5                            
timeT4:manageM5                            
timeT2:manageM6                            
timeT3:manageM6                            
timeT4:manageM6                            
timeT2:manageM7                            
timeT3:manageM7                            
timeT4:manageM7  0.500                     
timeT2:manageM8  0.250  0.250              
timeT3:manageM8  0.500  0.250  0.500       
timeT4:manageM8  0.250  0.500  0.500  0.500

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.53183600 -0.60511301 -0.07332633  0.62457774  1.97914273 

Number of Observations: 192
Number of Groups: 
          rep time %in% rep 
            3            12 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="check-model-assumptions" class="level4 page-columns page-full" data-number="5.2.1.3">
<h4 data-number="5.2.1.3" class="anchored" data-anchor-id="check-model-assumptions"><span class="header-section-number">5.2.1.3</span> <strong>Check Model Assumptions</strong></h4>
<p>Before interpreting the model we should investigate the assumptions of the model to ensure any conclusions we draw are valid. There are assumptions that we can check are 1. Homogeneity (equal variance) 2. normality of residuals 3. values with high leverage.</p>
<p>We can evaluate the assumptions in two ways: 1. By plotting model using <code>plot()</code> and residuals using <code>qqnorm()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="fu">resid</span>(., <span class="at">scaled=</span><span class="cn">TRUE</span>) <span class="sc">~</span> <span class="fu">fitted</span>(.), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"fitted values"</span>, <span class="at">ylab =</span> <span class="st">"studentized residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-split-plot_error" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-split-plot_error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="split-plot-design_files/figure-html/fig-split-plot_error-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-split-plot_error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Plot of residuals versus fitted values
</figcaption>
</figure>
</div>
</div></div></div>
<p>We are looking for a random and uniform distribution of points. This looks good!</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The same code works for nlme and lme4-generated models.</p>
</div></div><p>Checking normality requiring first extracting the model residuals with <code>resid()</code> and then generaing a qq-plot and line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model1), <span class="at">main =</span> <span class="cn">NULL</span>); <span class="fu">qqline</span>(<span class="fu">resid</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-split-plot_norm" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-split-plot_norm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="split-plot-design_files/figure-html/fig-split-plot_norm-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-split-plot_norm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: QQ-plot of residuals
</figcaption>
</figure>
</div>
</div></div></div>
<p>Or we can use <code>check_model()</code> function from ‘performance’ package. The plots generated using this code gives a visual check of various assumptions including normality of residuals, normality of random effects, heteroscedasticity, homogeneity of variance, and multicollinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking model assumptions</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting missing values (`NA`) into regular values currently not
  possible for variables of class `NULL`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="split-plot-design_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this case the residuals fit the assumptions of the model well.</p>
</section>
<section id="inference" class="level4" data-number="5.2.1.4">
<h4 data-number="5.2.1.4" class="anchored" data-anchor-id="inference"><span class="header-section-number">5.2.1.4</span> <strong>Inference</strong></h4>
<p>The <code>anova()</code> function prints the the rows of analysis of variance table for whole-plot, sub-plot, and their interactions. We observed a signficant effect if time and manage factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same syntax for lme4 &amp; nlme</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            numDF denDF   F-value p-value
(Intercept)     1   152 1560.4124  &lt;.0001
time            3     6    9.3310  0.0112
manage          7   152   10.8425  &lt;.0001
time:manage    21   152    1.1588  0.2955</code></pre>
</div>
</div>
<p>The estimated marginal means for each fixed effect and interaction effect can be obtained using <code>emmeans()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model1, <span class="sc">~</span> time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> time emmean  SE df lower.CL upper.CL
 T1      103 2.7  2     91.6      115
 T2      106 2.7  2     94.2      118
 T3      100 2.7  2     88.6      112
 T4      104 2.7  2     92.8      116

Results are averaged over the levels of: manage 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model1, <span class="sc">~</span> manage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> manage emmean   SE df lower.CL upper.CL
 M1      108.6 2.75  2     96.8      120
 M2      102.7 2.75  2     90.9      115
 M3      102.0 2.75  2     90.2      114
 M4      105.4 2.75  2     93.5      117
 M5      102.5 2.75  2     90.6      114
 M6      104.6 2.75  2     92.8      116
 M7       98.3 2.75  2     86.4      110
 M8      103.3 2.75  2     91.5      115

Results are averaged over the levels of: time 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Further, a pairwise comparison or contrasts can be analyzed using estimated means.</p>
<p>For example, if we want to compare difference in height at different time periods, this could be done using <code>pairs()</code> command from emmeans package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate   SE df t.ratio p.value
 T1 - T2     -2.68 1.11  6  -2.426  0.1719
 T1 - T3      2.95 1.11  6   2.665  0.1287
 T1 - T4     -1.21 1.11  6  -1.091  0.7072
 T2 - T3      5.63 1.11  6   5.091  0.0089
 T2 - T4      1.48 1.11  6   1.334  0.5767
 T3 - T4     -4.15 1.11  6  -3.756  0.0358

Results are averaged over the levels of: manage 
Degrees-of-freedom method: containment 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
</div>
<p>The letters indicating significant differences can be generated using cld() function from the ‘multcomp’ package”. In the output below, groups sharing a letter in the .group are not statistically different from each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(m1, <span class="at">Letters=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> time emmean  SE df lower.CL upper.CL .group
 T3      100 2.7  2     88.6      112  T    
 T1      103 2.7  2     91.6      115  TR   
 T4      104 2.7  2     92.8      116   R   
 T2      106 2.7  2     94.2      118   R   

Results are averaged over the levels of: manage 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(m2, <span class="at">Letters=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> manage emmean   SE df lower.CL upper.CL .group
 M7       98.3 2.75  2     86.4      110  T    
 M3      102.0 2.75  2     90.2      114  TR   
 M5      102.5 2.75  2     90.6      114   R   
 M2      102.7 2.75  2     90.9      115   R   
 M8      103.3 2.75  2     91.5      115   R   
 M6      104.6 2.75  2     92.8      116   R   
 M4      105.4 2.75  2     93.5      117   RU  
 M1      108.6 2.75  2     96.8      120    U  

Results are averaged over the levels of: time 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 8 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
</section>
<section id="example-model-for-rcbd-split-plot-designs" class="level3 page-columns page-full" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="example-model-for-rcbd-split-plot-designs"><span class="header-section-number">5.2.2</span> Example model for RCBD Split Plot Designs</h3>
<p>The oats data used in this example is from the MASS package. The design with RCBD split plot with 6 blocks, 3 main plots and 4 sub-plots. The primary outcome variable was oat yield.</p>
<p>Main plot = Variety (V), 3 levels</p>
<p>Subplot = Nitrogen (N), 4 levels</p>
<p>Number of blocks (B) = 6</p>
<p>Dependent variable = yield (Y)</p>
<p>The objective of this analysis is to study the impact of different varieties and nitrogen application rates on oat yields.</p>
<p>To fully examine the yield of oats due to varieties and nutrient levels in a split plots. We will need to statistically analyse and compare the effects of varieties, nutrient levels, their interaction, and the effects of plots and subplots.</p>
<section id="import-data-and-check-the-data-structure." class="level4 page-columns page-full" data-number="5.2.2.1">
<h4 data-number="5.2.2.1" class="anchored" data-anchor-id="import-data-and-check-the-data-structure."><span class="header-section-number">5.2.2.1</span> <strong>Import data and check the data structure.</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"oats"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(oats,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  B           V      N   Y
1 I     Victory 0.0cwt 111
2 I     Victory 0.2cwt 130
3 I     Victory 0.4cwt 157
4 I     Victory 0.6cwt 174
5 I Golden.rain 0.0cwt 117</code></pre>
</div>
</div>
<p>Evaluate the structure of the data. The “B”, “V”, and “N” needs to be ‘factor’ and “Y” should be numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(oats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ B: Factor w/ 6 levels "I","II","III",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ V: Factor w/ 3 levels "Golden.rain",..: 3 3 3 3 1 1 1 1 2 2 ...
 $ N: Factor w/ 4 levels "0.0cwt","0.2cwt",..: 1 2 3 4 1 2 3 4 1 2 ...
 $ Y: int  111 130 157 174 117 114 161 141 105 140 ...</code></pre>
</div>
</div>
<p>Running the table() command to verify the levels of main-plots and sub-plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(oats<span class="sc">$</span>V, oats<span class="sc">$</span>N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
              0.0cwt 0.2cwt 0.4cwt 0.6cwt
  Golden.rain      6      6      6      6
  Marvellous       6      6      6      6
  Victory          6      6      6      6</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Recall the model:</p>
<p><span class="math display">\[y_{ijk} = \mu + \rho_j +  \alpha_i + \beta_k + (\alpha_i\beta_k) + \epsilon_{ij} + \delta_{ijk}\]</span> Where:</p>
<p><span class="math inline">\(\mu\)</span> = overall experimental mean, <span class="math inline">\(\rho\)</span> = block effect (random), <span class="math inline">\(\alpha\)</span> = main effect of whole plot (fixed), <span class="math inline">\(\beta\)</span> = main effect of subplot (fixed), <span class="math inline">\(\alpha\)</span><span class="math inline">\(\beta\)</span> = interaction between factors A and B, <span class="math inline">\(\epsilon_{ij}\)</span> = whole plot error, <span class="math inline">\(\delta_{ijk}\)</span> = subplot error.</p>
</div></div></section>
<section id="building-the-model" class="level4" data-number="5.2.2.2">
<h4 data-number="5.2.2.2" class="anchored" data-anchor-id="building-the-model"><span class="header-section-number">5.2.2.2</span> <strong>Building the Model</strong></h4>
<p>We are evaluating the effect of V, N and their interaction on yield. The <code>1|B/V</code> implies that random intercepts vary with block and V within each block.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">lme4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">nlme</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Y <span class="sc">~</span>  V <span class="sc">+</span> N <span class="sc">+</span> V<span class="sc">:</span>N <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>B<span class="sc">/</span>V), </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> oats, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">na.action =</span> na.exclude)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Y ~ V + N + V:N + (1 | B/V)
   Data: oats

REML criterion at convergence: 529

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.81301 -0.56145  0.01758  0.63865  1.57034 

Random effects:
 Groups   Name        Variance Std.Dev.
 V:B      (Intercept) 106.1    10.30   
 B        (Intercept) 214.5    14.65   
 Residual             177.1    13.31   
Number of obs: 72, groups:  V:B, 18; B, 6

Fixed effects:
                    Estimate Std. Error t value
(Intercept)          80.0000     9.1070   8.784
VMarvellous           6.6667     9.7150   0.686
VVictory             -8.5000     9.7150  -0.875
N0.2cwt              18.5000     7.6829   2.408
N0.4cwt              34.6667     7.6829   4.512
N0.6cwt              44.8333     7.6829   5.835
VMarvellous:N0.2cwt   3.3333    10.8653   0.307
VVictory:N0.2cwt     -0.3333    10.8653  -0.031
VMarvellous:N0.4cwt  -4.1667    10.8653  -0.383
VVictory:N0.4cwt      4.6667    10.8653   0.430
VMarvellous:N0.6cwt  -4.6667    10.8653  -0.430
VVictory:N0.6cwt      2.1667    10.8653   0.199

Correlation of Fixed Effects:
            (Intr) VMrvll VVctry N0.2cw N0.4cw N0.6cw VM:N0.2 VV:N0.2 VM:N0.4
VMarvellous -0.533                                                           
VVictory    -0.533  0.500                                                    
N0.2cwt     -0.422  0.395  0.395                                             
N0.4cwt     -0.422  0.395  0.395  0.500                                      
N0.6cwt     -0.422  0.395  0.395  0.500  0.500                               
VMrvll:N0.2  0.298 -0.559 -0.280 -0.707 -0.354 -0.354                        
VVctry:N0.2  0.298 -0.280 -0.559 -0.707 -0.354 -0.354  0.500                 
VMrvll:N0.4  0.298 -0.559 -0.280 -0.354 -0.707 -0.354  0.500   0.250         
VVctry:N0.4  0.298 -0.280 -0.559 -0.354 -0.707 -0.354  0.250   0.500   0.500 
VMrvll:N0.6  0.298 -0.559 -0.280 -0.354 -0.354 -0.707  0.500   0.250   0.500 
VVctry:N0.6  0.298 -0.280 -0.559 -0.354 -0.354 -0.707  0.250   0.500   0.250 
            VV:N0.4 VM:N0.6
VMarvellous                
VVictory                   
N0.2cwt                    
N0.4cwt                    
N0.6cwt                    
VMrvll:N0.2                
VVctry:N0.2                
VMrvll:N0.4                
VVctry:N0.4                
VMrvll:N0.6  0.250         
VVctry:N0.6  0.500   0.500 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lme</span>(Y <span class="sc">~</span>  V <span class="sc">+</span> N <span class="sc">+</span> V<span class="sc">:</span>N ,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>B<span class="sc">/</span>V,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> oats, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="check-model-assumptions-1" class="level4" data-number="5.2.2.3">
<h4 data-number="5.2.2.3" class="anchored" data-anchor-id="check-model-assumptions-1"><span class="header-section-number">5.2.2.3</span> <strong>Check Model Assumptions</strong></h4>
<p>Normality of residuals and homogenous variance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking model assumptions</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="split-plot-design_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inference-1" class="level4" data-number="5.2.2.4">
<h4 data-number="5.2.2.4" class="anchored" data-anchor-id="inference-1"><span class="header-section-number">5.2.2.4</span> <strong>Inference</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
    npar  Sum Sq Mean Sq F value
V      2   526.1   263.0  1.4853
N      3 20020.5  6673.5 37.6857
V:N    6   321.7    53.6  0.3028</code></pre>
</div>
</div>
<p>Post-Hoc analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model2, <span class="sc">~</span> V <span class="sc">*</span>N) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>omparison <span class="ot">&lt;-</span> <span class="fu">cld</span>(emm, <span class="at">Letters =</span> LETTERS, <span class="at">reversed =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RCBD Split-plot
</div>
</div>
<div class="callout-body-container callout-body">
<p>The RCBD split-plot design is also commonly called split-block Design or the strip-plot Design</p>
</div>
</div>
</section>
</section>
</section>
<section id="split-split-plot-design" class="level1 page-columns page-full" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Split-split plot design</h1>
<p>The split-split-plot design is an extension of the split-plot design to accommodate a third factor: one factor in main-plot, other in subplot and the third factor in sub-subplot</p>
<section id="details-for-split-split-plot-designs" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="details-for-split-split-plot-designs"><span class="header-section-number">6.1</span> Details for split-split plot designs</h2>
<p>The statistical model structure this design:</p>
<p><span class="math display">\[y_{ijk} = \mu + \rho_j +  \alpha_i + \beta_k + (\alpha_i\beta_k) + \tau_n + (\alpha_i\tau_n) + (\tau_n\beta_k) + (\alpha_i\beta_k\tau_n) + \epsilon_{ijk} + \delta_{ijkn}\]</span> Where:</p>
<p><span class="math inline">\(\mu\)</span>= overall experimental mean, <span class="math inline">\(\alpha\)</span> = main effect of whole plot (fixed), <span class="math inline">\(\beta\)</span> = main effect of subplot (fixed), <span class="math inline">\(\tau\)</span> = main effect of sub-subplot, <span class="math inline">\(\epsilon_{ij}\)</span> = whole plot error, <span class="math inline">\(\delta_{ijk}\)</span> = subplot error.</p>
<p><span class="math display">\[ \epsilon \sim N(0, \sigma_\epsilon)\]</span></p>
<p><span class="math display">\[\ \delta  \sim N(0, \sigma_\delta)\]</span></p>
<p>Both the error and the rep effects are assumed to be normally distributed with a mean of zero and standard deviations of <span class="math inline">\(\sigma_\epsilon\)</span> and <span class="math inline">\(\sigma_\delta\)</span>, respectively.</p>
</section>
<section id="example-analysis" class="level2 page-columns page-full" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="example-analysis"><span class="header-section-number">6.2</span> Example Analysis</h2>
<p>In this example, we have a rice yield data from ‘agricolae’ package.</p>
<p>This consists of of 3 different rice varieties grown under 3 management practices and 5 Nitrogen levels in the split-split design, levels of each factor are outlined below:</p>
<p>blocks = block (3 blocks),</p>
<p>Whole plot factor = Nitrogen (5 levels)</p>
<p>Sub plot = management (3 levels)</p>
<p>sub-subplot = variety (3 levels)</p>
<section id="load-data-and-integrity-checks" class="level3 page-columns page-full" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="load-data-and-integrity-checks"><span class="header-section-number">6.2.1</span> <em>Load Data and integrity checks</em></h3>
<p>Here, we are extracting the rice yield data from <code>agricolae</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"external/ssp.csv"</span>, <span class="at">package=</span><span class="st">"agricolae"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>rice <span class="ot">&lt;-</span><span class="fu">read.csv</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Look at the structure of the data, class of block, nitrogen, management and variety should be a character/factor and yield should be numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(rice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   135 obs. of  5 variables:
 $ block     : int  1 1 1 1 1 1 1 1 1 1 ...
 $ nitrogen  : int  0 0 0 50 50 50 80 80 80 110 ...
 $ management: chr  "m1" "m2" "m3" "m1" ...
 $ variety   : int  1 1 1 1 1 1 1 1 1 1 ...
 $ yield     : num  3.32 3.77 4.66 3.19 3.62 ...</code></pre>
</div>
</div>
<p>Convert block, nitrogen, variety, and management to factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>rice<span class="sc">$</span>block<span class="ot">&lt;-</span><span class="fu">factor</span>(rice<span class="sc">$</span>block)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>rice<span class="sc">$</span>nitrogen<span class="ot">&lt;-</span><span class="fu">factor</span>(rice<span class="sc">$</span>nitrogen)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>rice<span class="sc">$</span>management<span class="ot">&lt;-</span><span class="fu">factor</span>(rice<span class="sc">$</span>management)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>rice<span class="sc">$</span>variety<span class="ot">&lt;-</span><span class="fu">factor</span>(rice<span class="sc">$</span>variety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, run a cross tabulations to check the independent variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(rice<span class="sc">$</span>variety, rice<span class="sc">$</span>nitrogen, rice<span class="sc">$</span>management)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = m1

   
    0 50 80 110 140
  1 3  3  3   3   3
  2 3  3  3   3   3
  3 3  3  3   3   3

, ,  = m2

   
    0 50 80 110 140
  1 3  3  3   3   3
  2 3  3  3   3   3
  3 3  3  3   3   3

, ,  = m3

   
    0 50 80 110 140
  1 3  3  3   3   3
  2 3  3  3   3   3
  3 3  3  3   3   3</code></pre>
</div>
</div>
<p>It looks perfectly balanced, with exactly 3 observation per treatment group.</p>
<p>Last, check the distribution of the dependent variable by plotting a histogram using a <code>hist()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rice<span class="sc">$</span>yield)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-split-split-plot_hist" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-split-split-plot_hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="split-plot-design_files/figure-html/fig-split-split-plot_hist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-split-split-plot_hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Histogram of the dependent variable.
</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section id="model-building-1" class="level3 page-columns page-full" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="model-building-1"><span class="header-section-number">6.2.2</span> Model Building</h3>
<p>The variance analysis of a split-split plot design is divided into three parts: the main-plot, subplot and sub-subplot analysis. We can use the nesting notation in the random part because nitrogen and management are nested in blocks. We can do blocks as fixed or random.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">lme4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">nlme</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(yield <span class="sc">~</span> nitrogen<span class="sc">*</span>management<span class="sc">*</span>variety <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>nitrogen<span class="sc">/</span>management),</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>rice, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
yield ~ nitrogen * management * variety + (1 | block/nitrogen/management)
   Data: rice

REML criterion at convergence: 232.1

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.72561 -0.49133 -0.05887  0.60262  1.95006 

Random effects:
 Groups                      Name        Variance Std.Dev.
 management:(nitrogen:block) (Intercept) 0.000000 0.0000  
 nitrogen:block              (Intercept) 0.009025 0.0950  
 block                       (Intercept) 0.000000 0.0000  
 Residual                                0.437110 0.6611  
Number of obs: 135, groups:  
management:(nitrogen:block), 45; nitrogen:block, 15; block, 3

Fixed effects:
                                   Estimate Std. Error t value
(Intercept)                        3.897000   0.385632  10.105
nitrogen50                         0.335000   0.545365   0.614
nitrogen80                         1.329000   0.545365   2.437
nitrogen110                        0.753333   0.545365   1.381
nitrogen140                        0.164667   0.545365   0.302
managementm2                       0.420333   0.539821   0.779
managementm3                       1.428000   0.539821   2.645
variety2                           1.449000   0.539821   2.684
variety3                           1.481333   0.539821   2.744
nitrogen50:managementm2           -0.076000   0.763422  -0.100
nitrogen80:managementm2            0.086000   0.763422   0.113
nitrogen110:managementm2           0.376667   0.763422   0.493
nitrogen140:managementm2           0.718000   0.763422   0.941
nitrogen50:managementm3           -0.177333   0.763422  -0.232
nitrogen80:managementm3           -0.107667   0.763422  -0.141
nitrogen110:managementm3           0.158000   0.763422   0.207
nitrogen140:managementm3           0.482000   0.763422   0.631
nitrogen50:variety2                0.240667   0.763422   0.315
nitrogen80:variety2               -0.695333   0.763422  -0.911
nitrogen110:variety2               0.152667   0.763422   0.200
nitrogen140:variety2               1.265000   0.763422   1.657
nitrogen50:variety3                1.068000   0.763422   1.399
nitrogen80:variety3                1.226000   0.763422   1.606
nitrogen110:variety3               1.321000   0.763422   1.730
nitrogen140:variety3               3.075000   0.763422   4.028
managementm2:variety2             -1.054667   0.763422  -1.381
managementm3:variety2             -1.343000   0.763422  -1.759
managementm2:variety3              0.697333   0.763422   0.913
managementm3:variety3              0.753667   0.763422   0.987
nitrogen50:managementm2:variety2   0.603667   1.079642   0.559
nitrogen80:managementm2:variety2   1.068667   1.079642   0.990
nitrogen110:managementm2:variety2  1.009667   1.079642   0.935
nitrogen140:managementm2:variety2  0.225000   1.079642   0.208
nitrogen50:managementm3:variety2   0.482667   1.079642   0.447
nitrogen80:managementm3:variety2   1.329000   1.079642   1.231
nitrogen110:managementm3:variety2  1.022667   1.079642   0.947
nitrogen140:managementm3:variety2  0.662667   1.079642   0.614
nitrogen50:managementm2:variety3  -0.006333   1.079642  -0.006
nitrogen80:managementm2:variety3  -0.569667   1.079642  -0.528
nitrogen110:managementm2:variety3 -0.322333   1.079642  -0.299
nitrogen140:managementm2:variety3 -1.054333   1.079642  -0.977
nitrogen50:managementm3:variety3   0.259667   1.079642   0.241
nitrogen80:managementm3:variety3  -0.816667   1.079642  -0.756
nitrogen110:managementm3:variety3 -0.541000   1.079642  -0.501
nitrogen140:managementm3:variety3 -1.292333   1.079642  -1.197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 45 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lme</span>(yield <span class="sc">~</span> nitrogen<span class="sc">*</span>management<span class="sc">*</span>variety,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>nitrogen<span class="sc">/</span>management,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> rice, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.action =</span> na.exclude)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: rice 
       AIC      BIC    logLik
  330.0696 452.5602 -116.0348

Random effects:
 Formula: ~1 | block
         (Intercept)
StdDev: 2.461632e-05

 Formula: ~1 | nitrogen %in% block
        (Intercept)
StdDev:  0.09500623

 Formula: ~1 | management %in% nitrogen %in% block
         (Intercept)  Residual
StdDev: 1.391254e-05 0.6611424

Fixed effects:  yield ~ nitrogen * management * variety 
                                      Value Std.Error DF   t-value p-value
(Intercept)                        3.897000 0.3856317 60 10.105497  0.0000
nitrogen50                         0.335000 0.5453656  8  0.614267  0.5561
nitrogen80                         1.329000 0.5453656  8  2.436898  0.0408
nitrogen110                        0.753333 0.5453656  8  1.381336  0.2045
nitrogen140                        0.164667 0.5453656  8  0.301938  0.7704
managementm2                       0.420333 0.5398205 20  0.778654  0.4453
managementm3                       1.428000 0.5398205 20  2.645324  0.0155
variety2                           1.449000 0.5398205 60  2.684226  0.0094
variety3                           1.481333 0.5398205 60  2.744122  0.0080
nitrogen50:managementm2           -0.076000 0.7634214 20 -0.099552  0.9217
nitrogen80:managementm2            0.086000 0.7634214 20  0.112651  0.9114
nitrogen110:managementm2           0.376667 0.7634214 20  0.493393  0.6271
nitrogen140:managementm2           0.718000 0.7634214 20  0.940503  0.3582
nitrogen50:managementm3           -0.177333 0.7634214 20 -0.232288  0.8187
nitrogen80:managementm3           -0.107667 0.7634214 20 -0.141032  0.8893
nitrogen110:managementm3           0.158000 0.7634214 20  0.206963  0.8381
nitrogen140:managementm3           0.482000 0.7634214 20  0.631368  0.5349
nitrogen50:variety2                0.240667 0.7634214 60  0.315247  0.7537
nitrogen80:variety2               -0.695333 0.7634214 60 -0.910812  0.3660
nitrogen110:variety2               0.152667 0.7634214 60  0.199977  0.8422
nitrogen140:variety2               1.265000 0.7634214 60  1.657014  0.1027
nitrogen50:variety3                1.068000 0.7634214 60  1.398965  0.1670
nitrogen80:variety3                1.226000 0.7634214 60  1.605928  0.1135
nitrogen110:variety3               1.321000 0.7634214 60  1.730368  0.0887
nitrogen140:variety3               3.075000 0.7634214 60  4.027919  0.0002
managementm2:variety2             -1.054667 0.7634214 60 -1.381500  0.1722
managementm3:variety2             -1.343000 0.7634214 60 -1.759186  0.0836
managementm2:variety3              0.697333 0.7634214 60  0.913432  0.3647
managementm3:variety3              0.753667 0.7634214 60  0.987222  0.3275
nitrogen50:managementm2:variety2   0.603667 1.0796409 60  0.559137  0.5781
nitrogen80:managementm2:variety2   1.068667 1.0796409 60  0.989835  0.3262
nitrogen110:managementm2:variety2  1.009667 1.0796409 60  0.935187  0.3534
nitrogen140:managementm2:variety2  0.225000 1.0796409 60  0.208403  0.8356
nitrogen50:managementm3:variety2   0.482667 1.0796409 60  0.447062  0.6564
nitrogen80:managementm3:variety2   1.329000 1.0796409 60  1.230965  0.2231
nitrogen110:managementm3:variety2  1.022667 1.0796409 60  0.947228  0.3473
nitrogen140:managementm3:variety2  0.662667 1.0796409 60  0.613784  0.5417
nitrogen50:managementm2:variety3  -0.006333 1.0796409 60 -0.005866  0.9953
nitrogen80:managementm2:variety3  -0.569667 1.0796409 60 -0.527645  0.5997
nitrogen110:managementm2:variety3 -0.322333 1.0796409 60 -0.298556  0.7663
nitrogen140:managementm2:variety3 -1.054333 1.0796409 60 -0.976559  0.3327
nitrogen50:managementm3:variety3   0.259667 1.0796409 60  0.240512  0.8108
nitrogen80:managementm3:variety3  -0.816667 1.0796409 60 -0.756424  0.4524
nitrogen110:managementm3:variety3 -0.541000 1.0796409 60 -0.501093  0.6181
nitrogen140:managementm3:variety3 -1.292333 1.0796409 60 -1.197003  0.2360
 Correlation: 
                                  (Intr) ntrg50 ntrg80 ntr110 ntr140 mngmn2
nitrogen50                        -0.707                                   
nitrogen80                        -0.707  0.500                            
nitrogen110                       -0.707  0.500  0.500                     
nitrogen140                       -0.707  0.500  0.500  0.500              
managementm2                      -0.700  0.495  0.495  0.495  0.495       
managementm3                      -0.700  0.495  0.495  0.495  0.495  0.500
variety2                          -0.700  0.495  0.495  0.495  0.495  0.500
variety3                          -0.700  0.495  0.495  0.495  0.495  0.500
nitrogen50:managementm2            0.495 -0.700 -0.350 -0.350 -0.350 -0.707
nitrogen80:managementm2            0.495 -0.350 -0.700 -0.350 -0.350 -0.707
nitrogen110:managementm2           0.495 -0.350 -0.350 -0.700 -0.350 -0.707
nitrogen140:managementm2           0.495 -0.350 -0.350 -0.350 -0.700 -0.707
nitrogen50:managementm3            0.495 -0.700 -0.350 -0.350 -0.350 -0.354
nitrogen80:managementm3            0.495 -0.350 -0.700 -0.350 -0.350 -0.354
nitrogen110:managementm3           0.495 -0.350 -0.350 -0.700 -0.350 -0.354
nitrogen140:managementm3           0.495 -0.350 -0.350 -0.350 -0.700 -0.354
nitrogen50:variety2                0.495 -0.700 -0.350 -0.350 -0.350 -0.354
nitrogen80:variety2                0.495 -0.350 -0.700 -0.350 -0.350 -0.354
nitrogen110:variety2               0.495 -0.350 -0.350 -0.700 -0.350 -0.354
nitrogen140:variety2               0.495 -0.350 -0.350 -0.350 -0.700 -0.354
nitrogen50:variety3                0.495 -0.700 -0.350 -0.350 -0.350 -0.354
nitrogen80:variety3                0.495 -0.350 -0.700 -0.350 -0.350 -0.354
nitrogen110:variety3               0.495 -0.350 -0.350 -0.700 -0.350 -0.354
nitrogen140:variety3               0.495 -0.350 -0.350 -0.350 -0.700 -0.354
managementm2:variety2              0.495 -0.350 -0.350 -0.350 -0.350 -0.707
managementm3:variety2              0.495 -0.350 -0.350 -0.350 -0.350 -0.354
managementm2:variety3              0.495 -0.350 -0.350 -0.350 -0.350 -0.707
managementm3:variety3              0.495 -0.350 -0.350 -0.350 -0.350 -0.354
nitrogen50:managementm2:variety2  -0.350  0.495  0.247  0.247  0.247  0.500
nitrogen80:managementm2:variety2  -0.350  0.247  0.495  0.247  0.247  0.500
nitrogen110:managementm2:variety2 -0.350  0.247  0.247  0.495  0.247  0.500
nitrogen140:managementm2:variety2 -0.350  0.247  0.247  0.247  0.495  0.500
nitrogen50:managementm3:variety2  -0.350  0.495  0.247  0.247  0.247  0.250
nitrogen80:managementm3:variety2  -0.350  0.247  0.495  0.247  0.247  0.250
nitrogen110:managementm3:variety2 -0.350  0.247  0.247  0.495  0.247  0.250
nitrogen140:managementm3:variety2 -0.350  0.247  0.247  0.247  0.495  0.250
nitrogen50:managementm2:variety3  -0.350  0.495  0.247  0.247  0.247  0.500
nitrogen80:managementm2:variety3  -0.350  0.247  0.495  0.247  0.247  0.500
nitrogen110:managementm2:variety3 -0.350  0.247  0.247  0.495  0.247  0.500
nitrogen140:managementm2:variety3 -0.350  0.247  0.247  0.247  0.495  0.500
nitrogen50:managementm3:variety3  -0.350  0.495  0.247  0.247  0.247  0.250
nitrogen80:managementm3:variety3  -0.350  0.247  0.495  0.247  0.247  0.250
nitrogen110:managementm3:variety3 -0.350  0.247  0.247  0.495  0.247  0.250
nitrogen140:managementm3:variety3 -0.350  0.247  0.247  0.247  0.495  0.250
                                  mngmn3 varty2 varty3 ntrgn50:m2 ntrgn80:m2
nitrogen50                                                                  
nitrogen80                                                                  
nitrogen110                                                                 
nitrogen140                                                                 
managementm2                                                                
managementm3                                                                
variety2                           0.500                                    
variety3                           0.500  0.500                             
nitrogen50:managementm2           -0.354 -0.354 -0.354                      
nitrogen80:managementm2           -0.354 -0.354 -0.354  0.500               
nitrogen110:managementm2          -0.354 -0.354 -0.354  0.500      0.500    
nitrogen140:managementm2          -0.354 -0.354 -0.354  0.500      0.500    
nitrogen50:managementm3           -0.707 -0.354 -0.354  0.500      0.250    
nitrogen80:managementm3           -0.707 -0.354 -0.354  0.250      0.500    
nitrogen110:managementm3          -0.707 -0.354 -0.354  0.250      0.250    
nitrogen140:managementm3          -0.707 -0.354 -0.354  0.250      0.250    
nitrogen50:variety2               -0.354 -0.707 -0.354  0.500      0.250    
nitrogen80:variety2               -0.354 -0.707 -0.354  0.250      0.500    
nitrogen110:variety2              -0.354 -0.707 -0.354  0.250      0.250    
nitrogen140:variety2              -0.354 -0.707 -0.354  0.250      0.250    
nitrogen50:variety3               -0.354 -0.354 -0.707  0.500      0.250    
nitrogen80:variety3               -0.354 -0.354 -0.707  0.250      0.500    
nitrogen110:variety3              -0.354 -0.354 -0.707  0.250      0.250    
nitrogen140:variety3              -0.354 -0.354 -0.707  0.250      0.250    
managementm2:variety2             -0.354 -0.707 -0.354  0.500      0.500    
managementm3:variety2             -0.707 -0.707 -0.354  0.250      0.250    
managementm2:variety3             -0.354 -0.354 -0.707  0.500      0.500    
managementm3:variety3             -0.707 -0.354 -0.707  0.250      0.250    
nitrogen50:managementm2:variety2   0.250  0.500  0.250 -0.707     -0.354    
nitrogen80:managementm2:variety2   0.250  0.500  0.250 -0.354     -0.707    
nitrogen110:managementm2:variety2  0.250  0.500  0.250 -0.354     -0.354    
nitrogen140:managementm2:variety2  0.250  0.500  0.250 -0.354     -0.354    
nitrogen50:managementm3:variety2   0.500  0.500  0.250 -0.354     -0.177    
nitrogen80:managementm3:variety2   0.500  0.500  0.250 -0.177     -0.354    
nitrogen110:managementm3:variety2  0.500  0.500  0.250 -0.177     -0.177    
nitrogen140:managementm3:variety2  0.500  0.500  0.250 -0.177     -0.177    
nitrogen50:managementm2:variety3   0.250  0.250  0.500 -0.707     -0.354    
nitrogen80:managementm2:variety3   0.250  0.250  0.500 -0.354     -0.707    
nitrogen110:managementm2:variety3  0.250  0.250  0.500 -0.354     -0.354    
nitrogen140:managementm2:variety3  0.250  0.250  0.500 -0.354     -0.354    
nitrogen50:managementm3:variety3   0.500  0.250  0.500 -0.354     -0.177    
nitrogen80:managementm3:variety3   0.500  0.250  0.500 -0.177     -0.354    
nitrogen110:managementm3:variety3  0.500  0.250  0.500 -0.177     -0.177    
nitrogen140:managementm3:variety3  0.500  0.250  0.500 -0.177     -0.177    
                                  ntrgn110:m2 ntrgn140:m2 ntrgn50:m3 ntrgn80:m3
nitrogen50                                                                     
nitrogen80                                                                     
nitrogen110                                                                    
nitrogen140                                                                    
managementm2                                                                   
managementm3                                                                   
variety2                                                                       
variety3                                                                       
nitrogen50:managementm2                                                        
nitrogen80:managementm2                                                        
nitrogen110:managementm2                                                       
nitrogen140:managementm2           0.500                                       
nitrogen50:managementm3            0.250       0.250                           
nitrogen80:managementm3            0.250       0.250       0.500               
nitrogen110:managementm3           0.500       0.250       0.500      0.500    
nitrogen140:managementm3           0.250       0.500       0.500      0.500    
nitrogen50:variety2                0.250       0.250       0.500      0.250    
nitrogen80:variety2                0.250       0.250       0.250      0.500    
nitrogen110:variety2               0.500       0.250       0.250      0.250    
nitrogen140:variety2               0.250       0.500       0.250      0.250    
nitrogen50:variety3                0.250       0.250       0.500      0.250    
nitrogen80:variety3                0.250       0.250       0.250      0.500    
nitrogen110:variety3               0.500       0.250       0.250      0.250    
nitrogen140:variety3               0.250       0.500       0.250      0.250    
managementm2:variety2              0.500       0.500       0.250      0.250    
managementm3:variety2              0.250       0.250       0.500      0.500    
managementm2:variety3              0.500       0.500       0.250      0.250    
managementm3:variety3              0.250       0.250       0.500      0.500    
nitrogen50:managementm2:variety2  -0.354      -0.354      -0.354     -0.177    
nitrogen80:managementm2:variety2  -0.354      -0.354      -0.177     -0.354    
nitrogen110:managementm2:variety2 -0.707      -0.354      -0.177     -0.177    
nitrogen140:managementm2:variety2 -0.354      -0.707      -0.177     -0.177    
nitrogen50:managementm3:variety2  -0.177      -0.177      -0.707     -0.354    
nitrogen80:managementm3:variety2  -0.177      -0.177      -0.354     -0.707    
nitrogen110:managementm3:variety2 -0.354      -0.177      -0.354     -0.354    
nitrogen140:managementm3:variety2 -0.177      -0.354      -0.354     -0.354    
nitrogen50:managementm2:variety3  -0.354      -0.354      -0.354     -0.177    
nitrogen80:managementm2:variety3  -0.354      -0.354      -0.177     -0.354    
nitrogen110:managementm2:variety3 -0.707      -0.354      -0.177     -0.177    
nitrogen140:managementm2:variety3 -0.354      -0.707      -0.177     -0.177    
nitrogen50:managementm3:variety3  -0.177      -0.177      -0.707     -0.354    
nitrogen80:managementm3:variety3  -0.177      -0.177      -0.354     -0.707    
nitrogen110:managementm3:variety3 -0.354      -0.177      -0.354     -0.354    
nitrogen140:managementm3:variety3 -0.177      -0.354      -0.354     -0.354    
                                  ntrgn110:m3 ntrgn140:m3 ntrgn50:v2 ntrgn80:v2
nitrogen50                                                                     
nitrogen80                                                                     
nitrogen110                                                                    
nitrogen140                                                                    
managementm2                                                                   
managementm3                                                                   
variety2                                                                       
variety3                                                                       
nitrogen50:managementm2                                                        
nitrogen80:managementm2                                                        
nitrogen110:managementm2                                                       
nitrogen140:managementm2                                                       
nitrogen50:managementm3                                                        
nitrogen80:managementm3                                                        
nitrogen110:managementm3                                                       
nitrogen140:managementm3           0.500                                       
nitrogen50:variety2                0.250       0.250                           
nitrogen80:variety2                0.250       0.250       0.500               
nitrogen110:variety2               0.500       0.250       0.500      0.500    
nitrogen140:variety2               0.250       0.500       0.500      0.500    
nitrogen50:variety3                0.250       0.250       0.500      0.250    
nitrogen80:variety3                0.250       0.250       0.250      0.500    
nitrogen110:variety3               0.500       0.250       0.250      0.250    
nitrogen140:variety3               0.250       0.500       0.250      0.250    
managementm2:variety2              0.250       0.250       0.500      0.500    
managementm3:variety2              0.500       0.500       0.500      0.500    
managementm2:variety3              0.250       0.250       0.250      0.250    
managementm3:variety3              0.500       0.500       0.250      0.250    
nitrogen50:managementm2:variety2  -0.177      -0.177      -0.707     -0.354    
nitrogen80:managementm2:variety2  -0.177      -0.177      -0.354     -0.707    
nitrogen110:managementm2:variety2 -0.354      -0.177      -0.354     -0.354    
nitrogen140:managementm2:variety2 -0.177      -0.354      -0.354     -0.354    
nitrogen50:managementm3:variety2  -0.354      -0.354      -0.707     -0.354    
nitrogen80:managementm3:variety2  -0.354      -0.354      -0.354     -0.707    
nitrogen110:managementm3:variety2 -0.707      -0.354      -0.354     -0.354    
nitrogen140:managementm3:variety2 -0.354      -0.707      -0.354     -0.354    
nitrogen50:managementm2:variety3  -0.177      -0.177      -0.354     -0.177    
nitrogen80:managementm2:variety3  -0.177      -0.177      -0.177     -0.354    
nitrogen110:managementm2:variety3 -0.354      -0.177      -0.177     -0.177    
nitrogen140:managementm2:variety3 -0.177      -0.354      -0.177     -0.177    
nitrogen50:managementm3:variety3  -0.354      -0.354      -0.354     -0.177    
nitrogen80:managementm3:variety3  -0.354      -0.354      -0.177     -0.354    
nitrogen110:managementm3:variety3 -0.707      -0.354      -0.177     -0.177    
nitrogen140:managementm3:variety3 -0.354      -0.707      -0.177     -0.177    
                                  ntrgn110:v2 ntrgn140:v2 ntrgn50:v3 ntrgn80:v3
nitrogen50                                                                     
nitrogen80                                                                     
nitrogen110                                                                    
nitrogen140                                                                    
managementm2                                                                   
managementm3                                                                   
variety2                                                                       
variety3                                                                       
nitrogen50:managementm2                                                        
nitrogen80:managementm2                                                        
nitrogen110:managementm2                                                       
nitrogen140:managementm2                                                       
nitrogen50:managementm3                                                        
nitrogen80:managementm3                                                        
nitrogen110:managementm3                                                       
nitrogen140:managementm3                                                       
nitrogen50:variety2                                                            
nitrogen80:variety2                                                            
nitrogen110:variety2                                                           
nitrogen140:variety2               0.500                                       
nitrogen50:variety3                0.250       0.250                           
nitrogen80:variety3                0.250       0.250       0.500               
nitrogen110:variety3               0.500       0.250       0.500      0.500    
nitrogen140:variety3               0.250       0.500       0.500      0.500    
managementm2:variety2              0.500       0.500       0.250      0.250    
managementm3:variety2              0.500       0.500       0.250      0.250    
managementm2:variety3              0.250       0.250       0.500      0.500    
managementm3:variety3              0.250       0.250       0.500      0.500    
nitrogen50:managementm2:variety2  -0.354      -0.354      -0.354     -0.177    
nitrogen80:managementm2:variety2  -0.354      -0.354      -0.177     -0.354    
nitrogen110:managementm2:variety2 -0.707      -0.354      -0.177     -0.177    
nitrogen140:managementm2:variety2 -0.354      -0.707      -0.177     -0.177    
nitrogen50:managementm3:variety2  -0.354      -0.354      -0.354     -0.177    
nitrogen80:managementm3:variety2  -0.354      -0.354      -0.177     -0.354    
nitrogen110:managementm3:variety2 -0.707      -0.354      -0.177     -0.177    
nitrogen140:managementm3:variety2 -0.354      -0.707      -0.177     -0.177    
nitrogen50:managementm2:variety3  -0.177      -0.177      -0.707     -0.354    
nitrogen80:managementm2:variety3  -0.177      -0.177      -0.354     -0.707    
nitrogen110:managementm2:variety3 -0.354      -0.177      -0.354     -0.354    
nitrogen140:managementm2:variety3 -0.177      -0.354      -0.354     -0.354    
nitrogen50:managementm3:variety3  -0.177      -0.177      -0.707     -0.354    
nitrogen80:managementm3:variety3  -0.177      -0.177      -0.354     -0.707    
nitrogen110:managementm3:variety3 -0.354      -0.177      -0.354     -0.354    
nitrogen140:managementm3:variety3 -0.177      -0.354      -0.354     -0.354    
                                  ntrgn110:v3 ntrgn140:v3 mng2:2 mng3:2 mng2:3
nitrogen50                                                                    
nitrogen80                                                                    
nitrogen110                                                                   
nitrogen140                                                                   
managementm2                                                                  
managementm3                                                                  
variety2                                                                      
variety3                                                                      
nitrogen50:managementm2                                                       
nitrogen80:managementm2                                                       
nitrogen110:managementm2                                                      
nitrogen140:managementm2                                                      
nitrogen50:managementm3                                                       
nitrogen80:managementm3                                                       
nitrogen110:managementm3                                                      
nitrogen140:managementm3                                                      
nitrogen50:variety2                                                           
nitrogen80:variety2                                                           
nitrogen110:variety2                                                          
nitrogen140:variety2                                                          
nitrogen50:variety3                                                           
nitrogen80:variety3                                                           
nitrogen110:variety3                                                          
nitrogen140:variety3               0.500                                      
managementm2:variety2              0.250       0.250                          
managementm3:variety2              0.250       0.250       0.500              
managementm2:variety3              0.500       0.500       0.500  0.250       
managementm3:variety3              0.500       0.500       0.250  0.500  0.500
nitrogen50:managementm2:variety2  -0.177      -0.177      -0.707 -0.354 -0.354
nitrogen80:managementm2:variety2  -0.177      -0.177      -0.707 -0.354 -0.354
nitrogen110:managementm2:variety2 -0.354      -0.177      -0.707 -0.354 -0.354
nitrogen140:managementm2:variety2 -0.177      -0.354      -0.707 -0.354 -0.354
nitrogen50:managementm3:variety2  -0.177      -0.177      -0.354 -0.707 -0.177
nitrogen80:managementm3:variety2  -0.177      -0.177      -0.354 -0.707 -0.177
nitrogen110:managementm3:variety2 -0.354      -0.177      -0.354 -0.707 -0.177
nitrogen140:managementm3:variety2 -0.177      -0.354      -0.354 -0.707 -0.177
nitrogen50:managementm2:variety3  -0.354      -0.354      -0.354 -0.177 -0.707
nitrogen80:managementm2:variety3  -0.354      -0.354      -0.354 -0.177 -0.707
nitrogen110:managementm2:variety3 -0.707      -0.354      -0.354 -0.177 -0.707
nitrogen140:managementm2:variety3 -0.354      -0.707      -0.354 -0.177 -0.707
nitrogen50:managementm3:variety3  -0.354      -0.354      -0.177 -0.354 -0.354
nitrogen80:managementm3:variety3  -0.354      -0.354      -0.177 -0.354 -0.354
nitrogen110:managementm3:variety3 -0.707      -0.354      -0.177 -0.354 -0.354
nitrogen140:managementm3:variety3 -0.354      -0.707      -0.177 -0.354 -0.354
                                  mng3:3 n50:2:2 n80:2:2 n110:2:2 n140:2:2
nitrogen50                                                                
nitrogen80                                                                
nitrogen110                                                               
nitrogen140                                                               
managementm2                                                              
managementm3                                                              
variety2                                                                  
variety3                                                                  
nitrogen50:managementm2                                                   
nitrogen80:managementm2                                                   
nitrogen110:managementm2                                                  
nitrogen140:managementm2                                                  
nitrogen50:managementm3                                                   
nitrogen80:managementm3                                                   
nitrogen110:managementm3                                                  
nitrogen140:managementm3                                                  
nitrogen50:variety2                                                       
nitrogen80:variety2                                                       
nitrogen110:variety2                                                      
nitrogen140:variety2                                                      
nitrogen50:variety3                                                       
nitrogen80:variety3                                                       
nitrogen110:variety3                                                      
nitrogen140:variety3                                                      
managementm2:variety2                                                     
managementm3:variety2                                                     
managementm2:variety3                                                     
managementm3:variety3                                                     
nitrogen50:managementm2:variety2  -0.177                                  
nitrogen80:managementm2:variety2  -0.177  0.500                           
nitrogen110:managementm2:variety2 -0.177  0.500   0.500                   
nitrogen140:managementm2:variety2 -0.177  0.500   0.500   0.500           
nitrogen50:managementm3:variety2  -0.354  0.500   0.250   0.250    0.250  
nitrogen80:managementm3:variety2  -0.354  0.250   0.500   0.250    0.250  
nitrogen110:managementm3:variety2 -0.354  0.250   0.250   0.500    0.250  
nitrogen140:managementm3:variety2 -0.354  0.250   0.250   0.250    0.500  
nitrogen50:managementm2:variety3  -0.354  0.500   0.250   0.250    0.250  
nitrogen80:managementm2:variety3  -0.354  0.250   0.500   0.250    0.250  
nitrogen110:managementm2:variety3 -0.354  0.250   0.250   0.500    0.250  
nitrogen140:managementm2:variety3 -0.354  0.250   0.250   0.250    0.500  
nitrogen50:managementm3:variety3  -0.707  0.250   0.125   0.125    0.125  
nitrogen80:managementm3:variety3  -0.707  0.125   0.250   0.125    0.125  
nitrogen110:managementm3:variety3 -0.707  0.125   0.125   0.250    0.125  
nitrogen140:managementm3:variety3 -0.707  0.125   0.125   0.125    0.250  
                                  n50:3:2 n80:3:2 n110:3:2 n140:3:2 n50:2:3
nitrogen50                                                                 
nitrogen80                                                                 
nitrogen110                                                                
nitrogen140                                                                
managementm2                                                               
managementm3                                                               
variety2                                                                   
variety3                                                                   
nitrogen50:managementm2                                                    
nitrogen80:managementm2                                                    
nitrogen110:managementm2                                                   
nitrogen140:managementm2                                                   
nitrogen50:managementm3                                                    
nitrogen80:managementm3                                                    
nitrogen110:managementm3                                                   
nitrogen140:managementm3                                                   
nitrogen50:variety2                                                        
nitrogen80:variety2                                                        
nitrogen110:variety2                                                       
nitrogen140:variety2                                                       
nitrogen50:variety3                                                        
nitrogen80:variety3                                                        
nitrogen110:variety3                                                       
nitrogen140:variety3                                                       
managementm2:variety2                                                      
managementm3:variety2                                                      
managementm2:variety3                                                      
managementm3:variety3                                                      
nitrogen50:managementm2:variety2                                           
nitrogen80:managementm2:variety2                                           
nitrogen110:managementm2:variety2                                          
nitrogen140:managementm2:variety2                                          
nitrogen50:managementm3:variety2                                           
nitrogen80:managementm3:variety2   0.500                                   
nitrogen110:managementm3:variety2  0.500   0.500                           
nitrogen140:managementm3:variety2  0.500   0.500   0.500                   
nitrogen50:managementm2:variety3   0.250   0.125   0.125    0.125          
nitrogen80:managementm2:variety3   0.125   0.250   0.125    0.125    0.500 
nitrogen110:managementm2:variety3  0.125   0.125   0.250    0.125    0.500 
nitrogen140:managementm2:variety3  0.125   0.125   0.125    0.250    0.500 
nitrogen50:managementm3:variety3   0.500   0.250   0.250    0.250    0.500 
nitrogen80:managementm3:variety3   0.250   0.500   0.250    0.250    0.250 
nitrogen110:managementm3:variety3  0.250   0.250   0.500    0.250    0.250 
nitrogen140:managementm3:variety3  0.250   0.250   0.250    0.500    0.250 
                                  n80:2:3 n110:2:3 n140:2:3 n50:3:3 n80:3:3
nitrogen50                                                                 
nitrogen80                                                                 
nitrogen110                                                                
nitrogen140                                                                
managementm2                                                               
managementm3                                                               
variety2                                                                   
variety3                                                                   
nitrogen50:managementm2                                                    
nitrogen80:managementm2                                                    
nitrogen110:managementm2                                                   
nitrogen140:managementm2                                                   
nitrogen50:managementm3                                                    
nitrogen80:managementm3                                                    
nitrogen110:managementm3                                                   
nitrogen140:managementm3                                                   
nitrogen50:variety2                                                        
nitrogen80:variety2                                                        
nitrogen110:variety2                                                       
nitrogen140:variety2                                                       
nitrogen50:variety3                                                        
nitrogen80:variety3                                                        
nitrogen110:variety3                                                       
nitrogen140:variety3                                                       
managementm2:variety2                                                      
managementm3:variety2                                                      
managementm2:variety3                                                      
managementm3:variety3                                                      
nitrogen50:managementm2:variety2                                           
nitrogen80:managementm2:variety2                                           
nitrogen110:managementm2:variety2                                          
nitrogen140:managementm2:variety2                                          
nitrogen50:managementm3:variety2                                           
nitrogen80:managementm3:variety2                                           
nitrogen110:managementm3:variety2                                          
nitrogen140:managementm3:variety2                                          
nitrogen50:managementm2:variety3                                           
nitrogen80:managementm2:variety3                                           
nitrogen110:managementm2:variety3  0.500                                   
nitrogen140:managementm2:variety3  0.500   0.500                           
nitrogen50:managementm3:variety3   0.250   0.250    0.250                  
nitrogen80:managementm3:variety3   0.500   0.250    0.250    0.500         
nitrogen110:managementm3:variety3  0.250   0.500    0.250    0.500   0.500 
nitrogen140:managementm3:variety3  0.250   0.250    0.500    0.500   0.500 
                                  n110:3:3
nitrogen50                                
nitrogen80                                
nitrogen110                               
nitrogen140                               
managementm2                              
managementm3                              
variety2                                  
variety3                                  
nitrogen50:managementm2                   
nitrogen80:managementm2                   
nitrogen110:managementm2                  
nitrogen140:managementm2                  
nitrogen50:managementm3                   
nitrogen80:managementm3                   
nitrogen110:managementm3                  
nitrogen140:managementm3                  
nitrogen50:variety2                       
nitrogen80:variety2                       
nitrogen110:variety2                      
nitrogen140:variety2                      
nitrogen50:variety3                       
nitrogen80:variety3                       
nitrogen110:variety3                      
nitrogen140:variety3                      
managementm2:variety2                     
managementm3:variety2                     
managementm2:variety3                     
managementm3:variety3                     
nitrogen50:managementm2:variety2          
nitrogen80:managementm2:variety2          
nitrogen110:managementm2:variety2         
nitrogen140:managementm2:variety2         
nitrogen50:managementm3:variety2          
nitrogen80:managementm3:variety2          
nitrogen110:managementm3:variety2         
nitrogen140:managementm3:variety2         
nitrogen50:managementm2:variety3          
nitrogen80:managementm2:variety3          
nitrogen110:managementm2:variety3         
nitrogen140:managementm2:variety3         
nitrogen50:managementm3:variety3          
nitrogen80:managementm3:variety3          
nitrogen110:managementm3:variety3         
nitrogen140:managementm3:variety3  0.500  

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.72560280 -0.49133728 -0.05886579  0.60262300  1.95004985 

Number of Observations: 135
Number of Groups: 
                              block                 nitrogen %in% block 
                                  3                                  15 
management %in% nitrogen %in% block 
                                 45 </code></pre>
</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><section id="boundary-singular-fit" class="level4" data-number="6.2.2.1">
<h4 data-number="6.2.2.1" class="anchored" data-anchor-id="boundary-singular-fit"><span class="header-section-number">6.2.2.1</span> boundary (singular) fit:</h4>
<p>We get a message that the fit is singular. What does this mean? Some components of the variance-covariance matrix of the random effects are either exactly zero or exactly one. OK what about in English? Basically it means that the algorithm that fits the model parameters doesn’t have enough data to get a good estimate. This often happens when we are trying to fit a model that is too complex for the amount of data we have, or when the random effects are very small and can’t be distinguished from zero. We still get some output but this message should make us take a close look at the random effects and their variances.</p>
</section></div></section>
<section id="check-model-assumptions-2" class="level3 page-columns page-full" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="check-model-assumptions-2"><span class="header-section-number">6.2.3</span> Check Model Assumptions</h3>
<p>Model Diagnostics: we are looking for a constant variance and normality of residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3, <span class="fu">resid</span>(., <span class="at">scaled=</span><span class="cn">TRUE</span>) <span class="sc">~</span> <span class="fu">fitted</span>(.), </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"fitted values"</span>, <span class="at">ylab =</span> <span class="st">"studentized residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-split-split-plot_error" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-split-split-plot_error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="split-plot-design_files/figure-html/fig-split-split-plot_error-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-split-split-plot_error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Plot of residuals versus fitted values
</figcaption>
</figure>
</div>
</div></div></div>
<p>Checking normality requiring first extracting the model residuals with <code>resid()</code> and then generating a qq-plot and qq-line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model3), <span class="at">main =</span> <span class="cn">NULL</span>); <span class="fu">qqline</span>(<span class="fu">resid</span>(model3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-split-split-plot_norm" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-split-split-plot_norm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="split-plot-design_files/figure-html/fig-split-split-plot_norm-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-split-split-plot_norm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: QQ-plot of residuals
</figcaption>
</figure>
</div>
</div></div></div>
<p>Or we can do all at one using one function <code>check_model()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting missing values (`NA`) into regular values currently not
  possible for variables of class `NULL`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="split-plot-design_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inference-2" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="inference-2"><span class="header-section-number">6.2.4</span> Inference</h3>
<p>Analysis of variance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            numDF denDF   F-value p-value
(Intercept)                     1    60 11188.782  &lt;.0001
nitrogen                        4     8    29.730  0.0001
management                      2    20    49.114  &lt;.0001
variety                         2    60   235.654  &lt;.0001
nitrogen:management             8    20     0.315  0.9509
nitrogen:variety                8    60     4.045  0.0007
management:variety              4    60     2.203  0.0794
nitrogen:management:variety    16    60     0.529  0.9210</code></pre>
</div>
</div>
<p>Determining the estimates for each treatment factor (variety, nitrogen, management)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(model3, <span class="sc">~</span> nitrogen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> nitrogen emmean    SE df lower.CL upper.CL
 0          5.38 0.139  2     4.79     5.98
 50         6.22 0.139  2     5.62     6.82
 80         7.00 0.139  2     6.40     7.59
 110        6.94 0.139  2     6.34     7.53
 140        7.23 0.139  2     6.64     7.83

Results are averaged over the levels of: management, variety 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(model3, <span class="sc">~</span> variety<span class="sc">*</span>management)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> variety management emmean    SE df lower.CL upper.CL
 1       m1           4.41 0.172  2     3.67     5.16
 2       m1           6.05 0.172  2     5.31     6.80
 3       m1           7.23 0.172  2     6.49     7.97
 1       m2           5.05 0.172  2     4.31     5.80
 2       m2           6.22 0.172  2     5.48     6.97
 3       m2           8.18 0.172  2     7.44     8.92
 1       m3           5.91 0.172  2     5.17     6.65
 2       m3           6.91 0.172  2     6.17     7.65
 3       m3           9.01 0.172  2     8.27     9.75

Results are averaged over the levels of: nitrogen 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>If the goal is to calculate estimates and know the statistics difference, that can be evaluated by using <code>cld()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model3, <span class="sc">~</span> nitrogen<span class="sc">*</span>variety) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">cld</span>(emm, <span class="at">Letters =</span> LETTERS, <span class="at">reversed =</span> T) </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> nitrogen variety emmean    SE df lower.CL upper.CL .group    
 140      3         9.34 0.227  2     8.36    10.31  A        
 80       3         8.56 0.227  2     7.59     9.54  AB       
 110      3         8.44 0.227  2     7.47     9.42  AB       
 50       3         7.88 0.227  2     6.90     8.86  ABC      
 140      2         7.29 0.227  2     6.31     8.27   BCD     
 110      2         6.92 0.227  2     5.95     7.90    CD     
 80       2         6.59 0.227  2     5.61     7.57    CDEF   
 0        3         6.48 0.227  2     5.50     7.46    CDE G  
 50       2         6.02 0.227  2     5.04     6.99     DEFGH 
 80       1         5.83 0.227  2     4.86     6.81     DEFGHI
 110      1         5.44 0.227  2     4.47     6.42      EFGHI
 0        2         5.16 0.227  2     4.19     6.14       F HI
 140      1         5.08 0.227  2     4.10     6.05        GHI
 50       1         4.76 0.227  2     3.79     5.74          I
 0        1         4.51 0.227  2     3.54     5.49          I

Results are averaged over the levels of: management 
Degrees-of-freedom method: containment 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 15 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/rcbd.html" class="pagination-link" aria-label="Randomized Complete Block Design">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Randomized Complete Block Design</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/factorial-design.html" class="pagination-link" aria-label="Factorial Design">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Factorial Design</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>